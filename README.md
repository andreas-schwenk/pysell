# pySELL

The Python based Simple E-Learning Language (SELL).

Push interactive STEM tasks to the web.

<!--Re-implementation of the essentials of the Simple E-Learning Language (SELL) for Longevity.-->

## Dependencies

**Users:** Only vanilla Python 3 is required to create basic questions. If you like to use symbolic calculations in your questions, then also `sympy` should be installed (`pip install sympy`).

**Developers:** Node.js + a local web server for debugging the web code (or alternatively install the recommended VS-code extension in this repository).

## User Guide

Download file `sell.py` from this repository. Only this file es required. All other files are used for the development of `pySELL`.

Run `python sell.py FILENAME.txt` to generate a self-contained quiz-website `FILENAME.html` from sources in `FILENAME.txt`. You will find an example below, and more examples in directory `examples/`.

_A short developer guide can be found at the end of this document._

## Example

The following example code generates some questions, as seen in the figure and available for testing [here](https://andreas-schwenk.github.io/pysell/ex1.html).

![](docs/example.jpg)

Command:

```bash
python sell.py ex1.txt
```

Files `ex1.html` and `ex1_DEBUG.html` will be generated. The latter file shows the sample solution.

Contents of `ex1.txt`;

```
LANG    en
TITLE   Demo
AUTHOR  Andreas Schwenk


QUESTION Multiple-Choice
Mark the correct answer(s)
[x] This answer is correct
[x] This answer is correct
[ ] This answer is incorrect


QUESTION Single-Choice
Mark the correct answer
(x) This answer is correct
( ) This answer is incorrect
( ) This answer is incorrect


# this is a comment line
QUESTION Addition
"""
import random
x = random.randint(10, 20)
y = random.randint(10, 20)
z = x + y
"""
Calculate $x + y =$ %z


QUESTION Fibonacci
"""
fib = [1] * 7
for i in range(2,len(fib)):
    fib[i] = fib[i-2] + fib[i-1]
fib3 = fib[3:]
"""
Complete the Fibonacci sequence
- $ 1, 1, 2, $ %fib3, ...
```

## Syntax

### Global

- `LANG` defines the language (currently, only `en` is supported).
- `TITLE` defines the pages title.
- `AUTHOR` defines the author/institution of the quizzes.
- `QUESTION` marks the beginning of a new question. The title of the question is written into the same line.
- `#` introduces a comment, i.e. text that is not considered.

### Questions

A question consists of a textual part, and optionally of Python code, to generate random variables and to calculate the sample solution.

**Question text**

- Text to be displayed is written in plain text.
- Italic text is embedded into a pair of single asterisks `*`.
- Bold text is embedded into a pair of double asterisks `**`.
- Embedded code is embedded into a pair of accent graves `\``.
- Itemizations are preceded by `-`.
- TeX-based inline math is embedded into a pair of `$`.
- TeX-based display style math is embedded into a pair of `$$` (display mode in inline math can be activated by writing e.g. `$\displaystyle \sum_{i=1}^n i^2$`)
- Multiple-Choice questions are preceded by `[x]` for correct answers, or `[ ]` for incorrect answers, respectively.
- Single-Choice questions are preceded by `(x)` for the correct answer, and `( )` for incorrect answers, respectively.
- A line break can be forces by `\\`.

**Question code**

To generate randomized variables, arbitrary Python-Code can be evaluated (this is secure, since the code is executed only locally on the teachers computer).

For each question, 5 instances are drawn. In case that you won't use random numbers, all generated instances are equal.

- Python code is embedded into a pair of `"""`. The triple-quotations must be written in distinct lines, without any other characters. Python code be provided before its variables are accessed in the textual part.

- Variables denoted in math mode in text are replaced by its actual values (the execution environment randomly chooses one of the 5 instances). This behavior can be suppressed by embedding the variable name into double quotes (e.g. write `"x"` instead of just `x`).

  **Warning: Variable names with underscore (e.g. `x_1`) are not allowed, since the underscore would be ambiguous in TeX.**

- Input fields a generated by `%` (or `%!` to suppress parentheses around the generated input fields in case of a vector/set input), followed the referred variable name. The structure of the input field depends on the variable type of the variable (`int`, `set`, `numpy.array`, ...).

- For asking gap questions, use `%`, followed the expected word(s), embedded into double quotes (e.g. `%"three"`).

_Hint: if a question as no input fields, the evaluation button is not shown._

<!-- TODO: write about types (impl is WIP):
int, float, set, matrix
-->

### Hints on generating random variables

_Note: also read about the custom function `rangeZ`, to exclude the zero from a range, below._

Read the docs:

- [https://docs.python.org/3/library/random.html](https://docs.python.org/3/library/random.html)

Examples:

#### Random number `a` in range `{-2,-1,...,5}`:

```python
import random
a = random.randint(-2,5)
# equivalent:
a = random.choice(range(-2,5+1))
```

#### Choose a random number `a` from a given set `{2,3,5,7}`:

```python
import random
a = random.choice([2,3,5,7])
```

_Note that the parameter is actually a list._

#### Get 3 random numbers `a`, `b`, `c` in range `{-2,-1,...,5}` with replacement:

```python
import random
# store in a, b, c
[a,b,c] = random.choices(range(-2,5+1),k=3)
# store as array x
x = random.choices(range(-2,5+1),k=3)
```

_Note that the upper bound of `range` is **excluded**._

#### Get 3 **unique** (i.e. without replacement) random numbers `a`, `b`, `c` in range `{-2,-1,...,5}`:

```python
import random
# store in scalar variables a, b, c
[a,b,c] = random.sample(range(-2,5+1),k=3)
# store as an array/list x
x = random.sample(range(-2,5+1),k=3)
# store as a set y
y = set(random.sample(range(-2,5+1),k=3))
```

#### _Note that the upper bound of `range` is **excluded**._

Shuffle a list `[2,4,6,8]` (e.g. to `[6,8,4,2]`):

```python
import random
# in place shuffling
x = [2,4,6,8]
random.shuffle(x)
# one liner with immutable input
x = random.sample([2,4,6,8],k=4)
```

#### Generate a 2 x 3 matrix `A` with elements in range `{-2,-1,...,5}` using `numpy`:

```python
import numpy
A = numpy.random.randint(-2, 5, size=(2,3))
# overwrite element A_{0,0}
A[0,0] = 1337
```

Elements are limited to $\mathbb{R}$.

#### Generate a 2 x 3 matrix `A` with elements in range `{-2,-1,...,5}` using `sympy`:

```python
from sympy import *
A = randMatrix(2,3, min=-2, max=5, symmetric=False)
# overwrite element A_{0,0}
x, y = symbols('x,y')
A[0,0] = sin(x) * cos(y)
```

Elements can also be terms.

#### Excluding the zero

In some cases, it may be beneficial to exclude the zero from random number generation.

<!--For example, if a numerical question would be too simple to solve in case that operands omit.-->

`pySELL` provides a function `rangeZ` that behaves syntactically as `range`, but excludes the zero.
Function `rangeZ` is automatically inserted before code provided by the user.

Example to get 3 random numbers `a`, `b`, `c` in range `{-2,-1,1,2,3}` with replacement:

```python
import random
# get a single random number
a = random.choice(rangeZ(-2,5+1))
# get 3 numbers with replacement (some of a,b,c may be equal)
[a,b,c] = random.choices(rangeZ(-2,3+1),k=3)
# get 3 numbers without replacement (a,b,c are distinct)
[a,b,c] = random.sample(rangeZ(-2,3+1),k=3)
```

_Note that the result of `rangeZ` is of type `list`, while the built-in function `range` returns type `range`._

## Developer Guide

To debug (or extend) the web code, first convert an input file into a json file with the `-J` option enables, e.g. `python3 sell.py -J src/ex1.txt`. Then `src/ex1.json` is generated.

Then start a local web server (e.g. using `python3 -m http.server 8000`) and open `index.html` (e.g. `localhost:8000`, if your port number is 8000). The uncompressed JavaScript code in directory `src/` is interpreted as module.

To update `sell.py` after any change in the JavaScript code, first install the dependency `esbuild` by `npm install`.
Then run `npm run build` (or `node build.js`) to update variable `html` in file `sell.py`.
